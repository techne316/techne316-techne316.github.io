<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Airspace Hugo theme">
<meta name="author" content="Somrat">










<title>affy::Background correction</title>

<meta name="generator" content="Hugo 0.59.0" />


    <link rel="stylesheet" href="https://techne316.github.io/css/owl.carousel.css" />
    <link rel="stylesheet" href="https://techne316.github.io/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://techne316.github.io/css/font-awesome.min.css" />
    <link rel="stylesheet" href="https://techne316.github.io/css/ionicons.min.css" />
    <link rel="stylesheet" href="https://techne316.github.io/css/animate.css" />
    <link rel="stylesheet" href="https://techne316.github.io/css/syntax.css" />
    <link rel="stylesheet" href="https://techne316.github.io/css/venobox.css" />
<!-- Main Stylesheet -->

<link rel="stylesheet" href="https://techne316.github.io/css/style.min.css" integrity="" media="screen">



<script src="https://techne316.github.io/js/jquery-1.10.2.min.js"></script>
<script src="https://techne316.github.io/js/bootstrap.min.js"></script>
<script src="https://techne316.github.io/js/owl.carousel.min.js"></script>
<script src="https://techne316.github.io/js/plugins.js"></script>
<script src="https://techne316.github.io/js/venobox.min.js"></script>


<!-- Main Script -->

<script src="https://techne316.github.io/js/main.min.js"></script>

<!-- google analitycs -->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'Your ID', 'auto');
    ga('send', 'pageview');
</script>



</head>
<body>

	
<header>
  <div class="container">
    <div class="row">
      <div class="col-md-12">

        
        <nav class="navbar navbar-default">
          <div class="container-fluid">
            
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
              </button>
              <a class="navbar-brand" href="https://techne316.github.io/">
                <img src="https://techne316.github.io/img/Techne.png" alt="KOREAN Techne homepage Logo" style="width:210px;height:55px;">
              </a>
            </div>

            
              <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                  <li><a href="https://techne316.github.io/"> 홈 </a>
                  </li>
                  
                  
                  <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      프로젝트
                    </a>
                    <div class="dropdown-menu" >
                      
                      <a class="dropdown-item" href="/kor/microarray">Microarray</a>
                      
                      <a class="dropdown-item" href="/kor/rnaseq">RNAseq</a>
                      
                    </div>
                  </li>
                  
                  
                  
                  <li class="nav-item">
                    <a class="nav-link" href="/kor/blog">블로그</a>
                  </li>
                  
                  
                  
                  <li class="nav-item">
                    <a class="nav-link" href="/kor/service">서비스</a>
                  </li>
                  
                  
                  
                  <li class="nav-item">
                    <a class="nav-link" href="/kor/contact">연락처</a>
                  </li>
                  
                  
                </ul>
               </div> 
          </div>
        </nav> 
               <div class ="row">
                 <div class="col-md-10"></div>
                 <div class="col-md-2">
                  <ul class="list-inline lang-list">
                  
                  <li class="list-inline-item"><a href="https://techne316.github.io/kor/" style="text-align:right;font-size:60%;">KOR</a></li>
                  
                  <li class="list-inline-item"><a href="https://techne316.github.io/" style="text-align:right;font-size:60%;">ENG</a></li>
                  
                  </ul>
                 </div> 

      </div>
    </div>
  </div>

</header>
	<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

	<div class="post">
	  
	  <section class="section" style="border: 1px dotted #ddd;">
	    <div class="container">
	      <div class="row">
				<!-- sidebar -->
<aside class="col-md-3 order-1 order-lg-2">
  <!-- categories -->
    <div class = "row">
      <div class = "col-md-1"></div>
      <div class = "col-md-8">
        <h4> LIST </h4>
        <ul class="list-styled style-circle">
          <li class="border-bottom border-color"><a href="/kor/categories/basic-r" class="text-color d-block pb-3 mt-3 text-decoration-none">Basic r</a></li>
          <li class="border-bottom border-color"><a href="/kor/categories/bioinformatics" class="text-color d-block pb-3 mt-3 text-decoration-none">Bioinformatics</a></li>
        </ul>
       <br>

      <!-- tags -->
        <h4>TAGS</h4>
        <ul class="list-inline tag-list">
          <li class="list-inline-item"><a class="hover-ripple" href="/kor/tags/affy">Affy</a></li>
          <li class="list-inline-item"><a class="hover-ripple" href="/kor/tags/basic">Basic</a></li>
          <li class="list-inline-item"><a class="hover-ripple" href="/kor/tags/limma">Limma</a></li>
          <li class="list-inline-item"><a class="hover-ripple" href="/kor/tags/r">R</a></li>
        </ul>
      </div> 
    </div> 

</aside>
<!-- /sidebar -->

	        <div class = "col-md-9">
	       	  <div class="block">
							
	            <h1>affy::Background correction</h1>
	            <h2>
	            <div class="post-info-wrapper">
	              <p class="italic">By <span class="bold">Techne316</span> </p>
	            </div>
	        	</h2>
	            <hr />
	            <p>

<h2 id="background-correction">Background correction</h2>

<hr />

<pre><code>## setting
library(affydata)
data(Dilution)
</code></pre>

<p>Background correction은 microarray에서 signal을 읽는 과정에서 noise를
줄이고, 전체적인 background를 잡아주는 역할을 합니다.</p>

<p><code>affy</code>에서 다루고 있는 background correction 방법에는 rma, mas으로 총
2가지 방법과 background correction이 없는 “none”옵션을 제시하고
있습니다.</p>

<p><br><br></p>

<h3 id="2-1-none">2.1 none</h3>

<p>어떠한 background correction없이 기존의 value 그대로를 이용하여
원본데이터를 사용하고자 할 때 선택할 수 있는 <code>none</code> 옵션입니다.</p>

<pre><code>bkg1 &lt;- bg.correct.none(Dilution) %&gt;% exprs()
</code></pre>

<p>Boxplot</p>

<p><img src="/img/bkg_correction_files/figure-markdown_strict/unnamed-chunk-1-1.png" alt="" /></p>

<p><br><br></p>

<h3 id="2-2-rma">2.2 rma</h3>

<p><code>rma()</code>방법은 robust multi-array average의 약자로 <a href="https://academic.oup.com/biostatistics/article/4/2/249/245074">Irizarry et al. (2003)</a>에 의해 고안된 방법입니다. 이 방법은  probe intensity의 empirical distribution에 의해 제안된 모델에 의해 PM(Perfect
Match) Probe의 intensity값을 조정합니다. 단, MM(Mis Match) probe들의
intensity는 조정되지 않습니다.</p>

<p>PM의 값은 normal noise component N(Normal with mean $\mu$ and variance $\sigma^2$)과 exponential signal component S(exponential with mean $\alpha$)을 따른다는 가정으로, 아래의 모델을 따라서 값이 조정됩니다.</p>

<p>$$ \mathsf{E}(s|O = 0) = a + b\dfrac{\phi(\dfrac{a}{b}) - \phi(\dfrac{o-a}{b}) }{\Phi(\dfrac{a}{b}) + \Phi(\dfrac{o-a}{b}) -1} $$</p>

<p>여기서, $\mathsf{a} = \mathsf{s}-\mu - \sigma^2$이고, $\mathsf{b} = \sigma$ 이며, $\phi$와 $\Phi$는 각각 standard normal distribution density와 distribution functions을 각각 의미합니다.</p>

<pre><code>bkg2 &lt;- bg.correct.rma(Dilution) %&gt;% exprs()
</code></pre>

<p>Boxplot</p>

<p><img src="/img/bkg_correction_files/figure-markdown_strict/unnamed-chunk-2-1.png" alt="" /></p>

<p><br><br></p>

<h3 id="2-3-mas">2.3 mas</h3>

<p><code>mas()</code>방법은 Statistical Algorithms Description Document Aﬀymetrix
(2002)에서 고안된 방법으로서, 한 개의 chip을 16개의 구역으로 나누어 각
구역에서 lowest 2%의 probe intensities를 기준으로 해서 각 구역의
background correction을 진행하는 방법입니다. 따라서 이 방법은,
PM(Perfect Match)와 MM(Mis Match) probe의 intensity에 조정이 들어갑니다.</p>

<pre><code>bkg3 &lt;- bg.correct.mas(Dilution) %&gt;% exprs()
</code></pre>

<p>Boxplot</p>

<p><img src="/img/bkg_correction_files/figure-markdown_strict/unnamed-chunk-3-1.png" alt="" />
<br></p>

<hr />

<h3 id="summary"><strong>SUMMARY</strong></h3>

<p><code>rma()</code>방법과 <code>mas5()</code>방법 중에서 더 좋은 background correction인지에
대한 의견은 실험에 따라 다르므로 한쪽이 더 좋은 방법이다라고 말하기는
어렵습니다. 다만, MAS5는 각각의 sample에서 background correction을
진행하므로 독립적이고 MM값을 조정한다는 점이 특징적이라면, RMA는 각각의
sample을 한번에 고려한 통계치를 이용한다는 점과, MM을 사용하지 않는 다는
점이 특징적입니다.</p>

<p><img src="/img/bkg_correction_files/figure-markdown_strict/unnamed-chunk-4-1.png" alt="" /></p>

<p><img src="/img/bkg_correction_files/figure-markdown_strict/unnamed-chunk-5-1.png" alt="" /></p>
</p>
	          </div>
	          <div></div>
	        </div>
	      </div>
	    </div>
	  </section>
	</div>
	<p class="center-text" style="padding: 30px;">
	  <a class="btn btn-main" href="https://techne316.github.io//blog">Back to blog</a>
	</p>

	
		
<section id="call-to-action" style="background-image: url('https://techne316.github.io/img/call-to-action-bg.jpg');">
  
  <div class="container">
    <div class="row">
      <div class ="col-md-3"></div>
      <div class="col-md-12">
        <div class="block">
          <h2>Dream as you wish</h2>
          <p>FRANCAIS Read more about what we do and our philosophy of design. Judge for yourself The work and results we’ve achieved for other clients, and meet our highly experienced Team who just love to design.</p>
          
          <a class="btn btn-main btn-solid-border" href="#" >tell us your story</a>
          
        </div>
      </div>
      <div class="col-md-3"></div>
    </div>
  </div>
</section>

	

	
<footer>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="footer-manu">
          <ul>
            
            <li><a href="#">About us</a></li>
            
            <li><a href="#">Contact us</a></li>
            
            <li><a href="#">How it works</a></li>
            
            <li><a href="#">Blog</a></li>
            
            <li><a href="#">Terms</a></li>
            
          </ul>
        </div>
        <p>Copyright &copy; Design &amp; Developed by Techne. All rights reserved.</p>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
