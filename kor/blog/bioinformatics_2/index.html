<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Airspace Hugo theme">
<meta name="author" content="Somrat">










<title>affy</title>

<meta name="generator" content="Hugo 0.59.0" />


    <link rel="stylesheet" href="http://localhost:1313/css/owl.carousel.css" />
    <link rel="stylesheet" href="http://localhost:1313/css/bootstrap.min.css" />
    <link rel="stylesheet" href="http://localhost:1313/css/font-awesome.min.css" />
    <link rel="stylesheet" href="http://localhost:1313/css/ionicons.min.css" />
    <link rel="stylesheet" href="http://localhost:1313/css/animate.css" />
    <link rel="stylesheet" href="http://localhost:1313/css/syntax.css" />
    <link rel="stylesheet" href="http://localhost:1313/css/venobox.css" />
<!-- Main Stylesheet -->

<link rel="stylesheet" href="http://localhost:1313/css/style.min.css" integrity="" media="screen">



<script src="http://localhost:1313/js/jquery-1.10.2.min.js"></script>
<script src="http://localhost:1313/js/bootstrap.min.js"></script>
<script src="http://localhost:1313/js/owl.carousel.min.js"></script>
<script src="http://localhost:1313/js/plugins.js"></script>
<script src="http://localhost:1313/js/venobox.min.js"></script>


<!-- Main Script -->

<script src="http://localhost:1313/js/main.min.js"></script>

<!-- google analitycs -->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'Your ID', 'auto');
    ga('send', 'pageview');
</script>



</head>
<body>

	
<header>
  <div class="container">
    <div class="row">
      <div class="col-md-12">

        
        <nav class="navbar navbar-default">
          <div class="container-fluid">
            
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
              </button>
              <a class="navbar-brand" href="http://localhost:1313/">
                <img src="http://localhost:1313/img/Techne.png" alt="KOREAN Techne homepage Logo" style="width:210px;height:55px;">
              </a>
            </div>

            
              <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                  <li><a href="http://localhost:1313/"> 홈 </a>
                  </li>
                  
                  
                  <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      프로젝트
                    </a>
                    <div class="dropdown-menu" >
                      
                      <a class="dropdown-item" href="/kor/microarray">Microarray</a>
                      
                      <a class="dropdown-item" href="/kor/rnaseq">RNAseq</a>
                      
                    </div>
                  </li>
                  
                  
                  
                  <li class="nav-item">
                    <a class="nav-link" href="/kor/blog">블로그</a>
                  </li>
                  
                  
                  
                  <li class="nav-item">
                    <a class="nav-link" href="/kor/service">서비스</a>
                  </li>
                  
                  
                  
                  <li class="nav-item">
                    <a class="nav-link" href="/kor/contact">연락처</a>
                  </li>
                  
                  
                </ul>
               </div> 
          </div>
        </nav> 
               <div class ="row">
                 <div class="col-md-10"></div>
                 <div class="col-md-2">
                  <ul class="list-inline lang-list">
                  
                  <li class="list-inline-item"><a href="http://localhost:1313/kor/" style="text-align:right;font-size:60%;">KOR</a></li>
                  
                  <li class="list-inline-item"><a href="http://localhost:1313/" style="text-align:right;font-size:60%;">ENG</a></li>
                  
                  </ul>
                 </div> 

      </div>
    </div>
  </div>

</header>
	

	<div class="post">
	  
	  <section class="section" style="border: 1px dotted #ddd;">
	    <div class="container">
	      <div class="row">
				<!-- sidebar -->
<aside class="col-md-3 order-1 order-lg-2">
  <!-- categories -->
    <div class = "row">
      <div class = "col-md-1"></div>
      <div class = "col-md-8">
        <h4> LIST </h4>
        <ul class="list-styled style-circle">
          <li class="border-bottom border-color"><a href="/kor/categories/basic-r" class="text-color d-block pb-3 mt-3 text-decoration-none">Basic r</a></li>
          <li class="border-bottom border-color"><a href="/kor/categories/bioinformatics" class="text-color d-block pb-3 mt-3 text-decoration-none">Bioinformatics</a></li>
        </ul>
       <br>

      <!-- tags -->
        <h4>TAGS</h4>
        <ul class="list-inline tag-list">
          <li class="list-inline-item"><a class="hover-ripple" href="/kor/tags/affy">Affy</a></li>
          <li class="list-inline-item"><a class="hover-ripple" href="/kor/tags/basic">Basic</a></li>
          <li class="list-inline-item"><a class="hover-ripple" href="/kor/tags/limma">Limma</a></li>
          <li class="list-inline-item"><a class="hover-ripple" href="/kor/tags/r">R</a></li>
        </ul>
      </div> 
    </div> 

</aside>
<!-- /sidebar -->

	        <div class = "col-md-9">
	       	  <div class="block">
							
	            <h1>affy</h1>
	            <h2>
	            <div class="post-info-wrapper">
	              <p class="italic">By <span class="bold">Techne316</span> </p>
	            </div>
	        	</h2>
	            <hr />
	            <p>

<p>The <em>affy</em> package designed to analyze and explore data of Affymetrix
oligonucleotide arrary probe level data. Also, the package includes
several plotting function to evaluate quality of array or probe level
intensity.</p>

<ul>
<li>probe oligonucleotides of 25 base pair length used to probe RNA
targets.</li>
<li>perfect match probes intended to match perfectly the target
sequence.</li>
<li>PM intensity value read from the perfect matches. mismatch the
probes having one base mismatch with the target sequence intended to
account for non-speciﬁc binding.</li>
<li>MM intensity value read from the mis-matches.</li>
<li>probe pair a unit composed of a perfect match and its mismatch.</li>
<li>aﬀyID an identiﬁcation for a probe set (which can be a gene or a
fraction of a gene) represented on the array.</li>
<li>probe pair set PMs and MMs related to a common aﬀyID.</li>
</ul>

<p>First of all, we will introduce some pre-processing method that affy
package supported using an example data. The example data set is
downloaded in the affydata package.</p>

<pre><code>library(affydata)
data(Dilution)
</code></pre>

<p><a href="https://www.bioconductor.org/packages/release/bioc/vignettes/affy/inst/doc/builtinMethods.pdf" class="uri"><a href="https://www.bioconductor.org/packages/release/bioc/vignettes/affy/inst/doc/builtinMethods.pdf">https://www.bioconductor.org/packages/release/bioc/vignettes/affy/inst/doc/builtinMethods.pdf</a></a></p>

<h3 id="1-1-rma">1.1 rma()</h3>

<pre><code>#eset1 &lt;- rma()
</code></pre>

<h3 id="1-2-justrma">1.2 justRMA</h3>

<pre><code>#eset2 &lt;- justRMA(celfile.path = H_dir)
</code></pre>

<h3 id="1-3-mas5">1.3 mas5()</h3>

<pre><code>#eset3 &lt;- mas5(Data)
</code></pre>

<h3 id="1-4-expresso">1.4 expresso()</h3>

<pre><code>#eset4 &lt;- expresso(Dilution,
#                  bgcorrect.method=&quot;none&quot;,
#                 normalize.method=&quot;constant&quot;,                      pmcorrect.method=&quot;pmonly&quot;,
# summary.method=&quot;liwong&quot;)

MAplot(Dilution, pairs = TRUE, plot.method = &quot;smoothScatter&quot;)
</code></pre>

<p><img src="/img/191014_2_files/figure-html/MAplot-1.png" alt="" /></p>

<pre><code> par(mfrow=c(2,2))
image(Dilution)
</code></pre>

<p><img src="/img/191014_2_files/figure-html/image-1.png" alt="" /></p>

<pre><code>boxplot(Dilution, col=c(2,3,4,5))
</code></pre>

<p><img src="/img/191014_2_files/figure-html/boxplot-1.png" alt="" /></p>

<h4 id="rna-degradation-plots">RNA degradation plots</h4>

<pre><code>degradation &lt;- AffyRNAdeg(Dilution)
summaryAffyRNAdeg(degradation)

##            20A    20B    10A    10B
## slope  -0.0239 0.0363 0.0273 0.0849
## pvalue  0.8920 0.8400 0.8750 0.6160

plotAffyRNAdeg(degradation)
</code></pre>

<p><img src="/img/191014_2_files/figure-html/RNAdeg-1.png" alt="" /></p>

<ol>
<li>Background correction
&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</li>
</ol>

<p>In affy package, there are 4 different background correction methods :
bg.correct, mas, none, rma</p>

<pre><code>eset1 &lt;- expresso(Dilution,
                  bgcorrect.method=&quot;none&quot;,
                  normalize.method=&quot;quantiles&quot;,
                  pmcorrect.method=&quot;pmonly&quot;,
                  summary.method=&quot;medianpolish&quot;)
eset2 &lt;- expresso(Dilution,
                  bgcorrect.method=&quot;rma&quot;,
                  normalize.method=&quot;quantiles&quot;,
                  pmcorrect.method=&quot;pmonly&quot;,
                  summary.method=&quot;medianpolish&quot;) #rma() default
</code></pre>

<h3 id="2-1-none">2.1 none</h3>

<p>If you choose “none” option in background correction parameter, it
returns original values as it is. <code>bgcorrect.method = &quot;none&quot;</code></p>

<pre><code>bkg1 &lt;- bg.correct.none(Dilution) %&gt;% exprs()
</code></pre>

<p>Boxplot</p>

<p><img src="/img/191014_2_files/figure-html/unnamed-chunk-1-1.png" alt="" /></p>

<h3 id="2-2-rma">2.2 rma</h3>

<p>These are background adjustment implementations for the rma method
Irizarry et al. (2003). They diﬀer only in how they estimate a set of
parameters (generally you should use rma in preference to rma2. In both
cases PM probe intensities are corrected by using a global model for the
distribution of probe intensities. The model is suggested by looking at
plots of the empirical distribution of probe intensities. In particular
the observed PM probes are modeled as the sum of a normal noise
component N (Normal with mean µ and variance σ2) and a exponential
signal component S (exponential with mean α). To avoid any possibility
of negatives, the normal is truncated at zero. Given we have O the
observed intensity, this then leads to an adjustment.<br />
E (s|O = o) = a + b φa b−φo−a b Φ a b+ Φo−a b −1where a = s−µ−σ2α
and b = σ. Note that φ and Φ are the standard normal distribution
density and distribution functions respectively. Note that MM probe
intensities are not corrected by either of these routines.</p>

<pre><code>bkg2 &lt;- bg.correct.rma(Dilution) %&gt;% exprs()
</code></pre>

<p>Boxplot</p>

<p><img src="/img/Basic_R_1.1_files/figure-html/continuous2-1.png" alt="" /><!-- --></p>

<p><img src="/img/191014_2_files/figure-html/unnamed-chunk-2-1.png" alt="" /></p>

<p><img src="/img/191014_2_files/figure-html/unnamed-chunk-3-1.png" alt="" /></p>

<h3 id="2-3-mas">2.3 mas</h3>

<p>This is an implementation of the background correction method outlined
in the Statistical Algorithms Description Document Aﬀymetrix (2002). The
chip is broken into a grid of 16 rectangular regions. For each region
the lowest 2% of probe intensities are used to compute a background
value for that grid. Each probe is then adjusted based upon a weighted
average of the backgrounds for each of the regions. The weights are
based on the distances between the location of the probe and the
centriods of 16 diﬀerent regions. Note this method corrects both PM and
MM probes.</p>

<pre><code>bkg3 &lt;- bg.correct.mas(Dilution) %&gt;% exprs()
</code></pre>

<p>Boxplot</p>

<p><img src="191014_2_files/unnamed-chunk-4-1.png" alt="" /></p>

<p><img src="191014_2_files/unnamed-chunk-5-1.png" alt="" /></p>

<hr />

<h3 id="summary"><strong>SUMMARY</strong></h3>

<p><img src="/img//img/191014_2_files/figure-html/unnamed-chunk-6-1.png" alt="" /></p>

<p><img src="/img/191014_2_files/figure-html/unnamed-chunk-7-1.png" alt="" /></p>

<ol>
<li>Normalization
&mdash;&mdash;&mdash;&mdash;&mdash;-</li>
</ol>

<p>constant, contrasts, invariantset, loess, methods, qspline, quantiles,
quantiles.robust constant, contrasts, invariantset, loess, methods,
qspline, quantiles, quantiles.robust</p>

<p>First of all, original data set might be like this :
<img src="/img/191014_2_files/figure-html/unnamed-chunk-8-1.png" alt="" /></p>

<p>However, affy package support 8 different normalization methods, such as
<code>r normalize.AffyBatch.methods()[c(1:4,6:8)]</code></p>

<p>To check difference between methods,</p>

<p><img src="/img/191014_2_files/figure-html/unnamed-chunk-9-1.png" alt="" /></p>

<p><img src="/img/191014_2_files/figure-html/unnamed-chunk-10-1.png" alt="" /></p>

<ol>
<li>Probe specific background correction
&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</li>
</ol>
</p>
	          </div>
	          <div></div>
	        </div>
	      </div>
	    </div>
	  </section>
	</div>
	<p class="center-text" style="padding: 30px;">
	  <a class="btn btn-main" href="http://localhost:1313//blog">Back to blog</a>
	</p>

	
		
<section id="call-to-action" style="background-image: url('http://localhost:1313/img/call-to-action-bg.jpg');">
  
  <div class="container">
    <div class="row">
      <div class ="col-md-3"></div>
      <div class="col-md-12">
        <div class="block">
          <h2>Dream as you wish</h2>
          <p>FRANCAIS Read more about what we do and our philosophy of design. Judge for yourself The work and results we’ve achieved for other clients, and meet our highly experienced Team who just love to design.</p>
          
          <a class="btn btn-main btn-solid-border" href="#" >tell us your story</a>
          
        </div>
      </div>
      <div class="col-md-3"></div>
    </div>
  </div>
</section>

	

	
<footer>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="footer-manu">
          <ul>
            
            <li><a href="#">About us</a></li>
            
            <li><a href="#">Contact us</a></li>
            
            <li><a href="#">How it works</a></li>
            
            <li><a href="#">Blog</a></li>
            
            <li><a href="#">Terms</a></li>
            
          </ul>
        </div>
        <p>Copyright &copy; Design &amp; Developed by Techne. All rights reserved.</p>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
